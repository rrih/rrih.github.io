#!/usr/bin/env sh
# Mandatory pre-commit checks - NEVER SKIP
echo "ğŸ”’ Running mandatory pre-commit checks..."
echo "âš ï¸  This ensures ZERO CI failures. Cannot be bypassed."

# Run TypeScript check
echo "ğŸ“ Checking TypeScript..."
if ! bun --bun tsc --noEmit; then
  echo "âŒ TypeScript check failed! Fix errors before committing."
  exit 1
fi

# Run Biome linting
echo "ğŸ§¹ Running Biome check..."
if ! bun run lint; then
  echo "âŒ Biome linting failed! Fix linting errors before committing."
  exit 1
fi

# Run tests
echo "ğŸ§ª Running tests..."
if ! bun test; then
  echo "âŒ Tests failed! Fix failing tests before committing."
  exit 1
fi

# Run build check
echo "ğŸ—ï¸ Testing build..."
if ! bun run build; then
  echo "âŒ Build failed! Fix build errors before committing."
  exit 1
fi

# Add any files generated during build (e.g., sw.js)
echo "ğŸ“¦ Adding build-generated files to commit..."
git add .

echo "âœ… All pre-commit checks passed! Proceeding with commit..."
